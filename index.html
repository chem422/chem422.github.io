<!DOCTYPE html>
<html>
<head>
  <title>Duck Hunt Rocket Launcher</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    body { margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; background: linear-gradient(#87CEEB, #4682B4); }
    canvas { border: 2px solid #333; box-shadow: 0 0 10px rgba(0,0,0,0.5); }
    .hud { position: absolute; top: 10px; left: 10px; right: 10px; color: white; font-family: 'Press Start 2P', cursive; font-size: 14px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }
    .score { position: absolute; top: 10px; right: 20px; font-size: 20px; }
  </style>
</head>
<body>
<div class="hud">
  <div>Duck Hunt: Rocket Frenzy</div>
  <div style="font-size: 10px; margin-top: 5px;">Click to shoot | Hit power-ups for boosts!</div>
</div>
<script>
let ducks = [];
let rockets = [];
let explosions = [];
let scoreTexts = [];
let powerUps = [];
let score = 0;
let ctx;
let speedBoost = false;
let multiShot = false;
let bigRocket = false;
let scoreMultiplier = false;
let rapidFire = false;
let boostTimer = 0;
let fireDelay = 0;
const baseFireDelay = 10;

function setup() {
  createCanvas(800, 600);
  ctx = new (window.AudioContext || window.webkitAudioContext)();
  for (let i = 0; i < 8; i++) {
    spawnDuck();
  }
  setInterval(spawnPowerUp, 10000);
}

function draw() {
  // Gradient background
  let c1 = color(135, 206, 235);
  let c2 = color(70, 130, 180);
  for (let y = 0; y < height; y++) {
    let n = map(y, 0, height, 0, 1);
    let newColor = lerpColor(c1, c2, n);
    stroke(newColor);
    line(0, y, width, y);
  }
  // Update boost timer
  if (speedBoost || multiShot || bigRocket || scoreMultiplier || rapidFire) {
    boostTimer--;
    if (boostTimer <= 0) {
      speedBoost = false;
      multiShot = false;
      bigRocket = false;
      scoreMultiplier = false;
      rapidFire = false;
    }
  }
  // Update fire delay
  if (fireDelay > 0) fireDelay--;
  // Draw and update ducks
  for (let i = ducks.length - 1; i >= 0; i--) {
    let duck = ducks[i];
    duck.update();
    duck.show();
    if (duck.offScreen()) {
      ducks.splice(i, 1);
      spawnDuck();
    }
  }
  // Draw and update rockets
  for (let i = rockets.length - 1; i >= 0; i--) {
    let rocket = rockets[i];
    rocket.update();
    rocket.show();
    if (rocket.offScreen()) {
      rockets.splice(i, 1);
    } else {
      // Check duck collisions
      for (let j = ducks.length - 1; j >= 0; j--) {
        if (rocket.hits(ducks[j])) {
          explosions.push(new Explosion(ducks[j].x, ducks[j].y));
          playExplosionSound();
          score += scoreMultiplier ? 20 : 10;
          scoreTexts.push(new ScoreText(ducks[j].x, ducks[j].y));
          ducks.splice(j, 1);
          rockets.splice(i, 1);
          spawnDuck();
          break;
        }
      }
      // Check power-up collisions
      for (let j = powerUps.length - 1; j >= 0; j--) {
        if (rocket.hits(powerUps[j])) {
          activatePowerUp(powerUps[j].type);
          playPowerUpSound();
          powerUps.splice(j, 1);
          break;
        }
      }
    }
  }
  // Draw and update explosions
  for (let i = explosions.length - 1; i >= 0; i--) {
    explosions[i].update();
    explosions[i].show();
    if (explosions[i].isDone()) {
      explosions.splice(i, 1);
    }
  }
  // Draw and update score texts
  for (let i = scoreTexts.length - 1; i >= 0; i--) {
    scoreTexts[i].update();
    scoreTexts[i].show();
    if (scoreTexts[i].isDone()) {
      scoreTexts.splice(i, 1);
    }
  }
  // Draw and update power-ups
  for (let i = powerUps.length - 1; i >= 0; i--) {
    powerUps[i].update();
    powerUps[i].show();
    if (powerUps[i].offScreen()) {
      powerUps.splice(i, 1);
    }
  }
  // Draw rocket launcher
  fill(80);
  rect(mouseX - 25, height - 50, 50, 30, 5);
  fill(200, 50, 50);
  triangle(mouseX - 15, height - 50, mouseX + 15, height - 50, mouseX, height - 70);
  fill(0, 255, 0);
  rect(mouseX - 25, height - 20, 50, 10);
  // Draw score
  push();
  textFont('Press Start 2P');
  fill(255);
  stroke(0);
  strokeWeight(3);
  textSize(20);
  textAlign(RIGHT);
  text(`Score: ${score}`, width - 10, 30);
  pop();
  // Draw power-up status
  if (speedBoost || multiShot || bigRocket || scoreMultiplier || rapidFire) {
    fill(255, 255, 0);
    textSize(12);
    textAlign(LEFT);
    let powerName = speedBoost ? 'Speed' : multiShot ? 'Multi' : bigRocket ? 'Big' : scoreMultiplier ? '2x Score' : 'Rapid';
    text(`Power: ${powerName} (${floor(boostTimer/60)}s)`, 10, 50);
  }
}

function mousePressed() {
  if (fireDelay > 0) return;
  if (multiShot) {
    rockets.push(new Rocket(mouseX - 20, height - 50));
    rockets.push(new Rocket(mouseX, height - 50));
    rockets.push(new Rocket(mouseX + 20, height - 50));
  } else {
    rockets.push(new Rocket(mouseX, height - 50));
  }
  fireDelay = rapidFire ? baseFireDelay / 2 : baseFireDelay;
}

class Duck {
  constructor() {
    this.size = random(20, 50);
    this.x = -this.size;
    this.y = random(50, height - 100);
    this.speed = random(2, 6);
    this.color = color(random(100, 255), random(100, 255), random(100, 255));
    this.phase = random(TWO_PI);
  }
  update() {
    this.x += this.speed;
    this.y += sin(this.x * 0.05 + this.phase) * 0.5;
  }
  show() {
    push();
    translate(this.x, this.y);
    fill(this.color);
    ellipse(0, 0, this.size, this.size * 0.6);
    ellipse(-this.size * 0.3, -this.size * 0.2, this.size * 0.4, this.size * 0.4);
    fill(this.color, 200);
    ellipse(-this.size * 0.2, 0, this.size * 0.5, this.size * 0.3);
    ellipse(this.size * 0.2, 0, this.size * 0.5, this.size * 0.3);
    fill(0);
    ellipse(-this.size * 0.2, -this.size * 0.2, 5, 5);
    fill(255, 165, 0);
    triangle(
      this.size * 0.2, 0,
      this.size * 0.4, -5,
      this.size * 0.4, 5
    );
    pop();
  }
  offScreen() {
    return this.x > width + this.size;
  }
}

class Rocket {
  constructor(x, y) {
    this.x = x;
    this.y = y;
    this.speed = speedBoost ? -15 : -10;
    this.size = bigRocket ? 15 : 10;
  }
  update() {
    this.y += this.speed;
  }
  show() {
    push();
    translate(this.x, this.y);
    fill(169, 169, 169);
    rect(-this.size/2, -this.size, this.size, this.size * 2, 3);
    fill(255, 0, 0);
    triangle(-this.size/2, -this.size, this.size/2, -this.size, 0, -this.size * 2);
    fill(255, 255, 0);
    ellipse(0, this.size, this.size/2, this.size);
    pop();
  }
  offScreen() {
    return this.y < -this.size * 2;
  }
  hits(obj) {
    let d = dist(this.x, this.y, obj.x, obj.y);
    return d < obj.size / 2 + this.size;
  }
}

class Explosion {
  constructor(x, y) {
    this.x = x;
    this.y = y;
    this.particles = [];
    for (let i = 0; i < 30; i++) {
      this.particles.push({
        x: x,
        y: y,
        vx: random(-4, 4),
        vy: random(-4, 4),
        alpha: 255,
        size: random(5, 20),
        color: random() > 0.5 ? color(255, 100, 0) : color(255, 255, 0)
      });
    }
  }
  update() {
    for (let p of this.particles) {
      p.x += p.vx;
      p.y += p.vy;
      p.alpha -= 4;
      p.size *= 0.97;
    }
  }
  show() {
    noStroke();
    for (let p of this.particles) {
      fill(p.color, p.alpha);
      ellipse(p.x, p.y, p.size);
    }
  }
  isDone() {
    return this.particles[0].alpha <= 0;
  }
}

class ScoreText {
  constructor(x, y) {
    this.x = x;
    this.y = y;
    this.alpha = 255;
    this.vy = -1.5;
  }
  update() {
    this.y += this.vy;
    this.alpha -= 3;
  }
  show() {
    push();
    textFont('Press Start 2P');
    fill(255, 255, 0, this.alpha);
    stroke(0);
    strokeWeight(2);
    textSize(18);
    text(`+${scoreMultiplier ? 20 : 10}`, this.x, this.y);
    pop();
  }
  isDone() {
    return this.alpha <= 0;
  }
}

class PowerUp {
  constructor() {
    this.x = -20;
    this.y = random(50, height - 100);
    this.size = 20;
    this.speed = random(1, 3);
    let r = random();
    this.type = r < 0.25 ? 'speed' : r < 0.5 ? 'multi' : r < 0.75 ? 'big' : 'score';
    this.type = r < 0.2 ? 'speed' : r < 0.4 ? 'multi' : r < 0.6 ? 'big' : r < 0.8 ? 'score' : 'rapid';
  }
  update() {
    this.x += this.speed;
  }
  show() {
    push();
    translate(this.x, this.y);
    let c = this.type === 'speed' ? color(0, 255, 255) : 
            this.type === 'multi' ? color(255, 0, 255) : 
            this.type === 'big' ? color(255, 165, 0) : 
            this.type === 'score' ? color(255, 255, 0) : color(0, 255, 0);
    fill(c);
    ellipse(0, 0, this.size);
    fill(255);
    textAlign(CENTER, CENTER);
    textSize(12);
    text(this.type === 'speed' ? 'S' : this.type === 'multi' ? 'M' : this.type === 'big' ? 'B' : this.type === 'score' ? 'X' : 'R', 0, 0);
    pop();
  }
  offScreen() {
    return this.x > width + this.size;
  }
}

function activatePowerUp(type) {
  speedBoost = false;
  multiShot = false;
  bigRocket = false;
  scoreMultiplier = false;
  rapidFire = false;
  if (type === 'speed') {
    speedBoost = true;
  } else if (type === 'multi') {
    multiShot = true;
  } else if (type === 'big') {
    bigRocket = true;
  } else if (type === 'score') {
    scoreMultiplier = true;
  } else if (type === 'rapid') {
    rapidFire = true;
  }
  boostTimer = 300; // 5 seconds at 60 FPS
}

function playExplosionSound() {
  let oscillator = ctx.createOscillator();
  let gainNode = ctx.createGain();
  oscillator.connect(gainNode);
  gainNode.connect(ctx.destination);
  oscillator.type = 'square';
  oscillator.frequency.setValueAtTime(100, ctx.currentTime);
  gainNode.gain.setValueAtTime(0.1, ctx.currentTime);
  gainNode.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.5);
  oscillator.start();
  oscillator.stop(ctx.currentTime + 0.5);
}

function playPowerUpSound() {
  let oscillator = ctx.createOscillator();
  let gainNode = ctx.createGain();
  oscillator.connect(gainNode);
  gainNode.connect(ctx.destination);
  oscillator.type = 'sine';
  oscillator.frequency.setValueAtTime(440, ctx.currentTime);
  gainNode.gain.setValueAtTime(0.1, ctx.currentTime);
  gainNode.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.3);
  oscillator.start();
  oscillator.stop(ctx.currentTime + 0.3);
}

function spawnDuck() {
  ducks.push(new Duck());
}

function spawnPowerUp() {
  if (powerUps.length < 2) {
    powerUps.push(new PowerUp());
  }
}
</script>
</body>
</html>
